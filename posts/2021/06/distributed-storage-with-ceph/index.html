<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="What is ceph Ceph is a software-defined storage solution designed to address the object, block, and file storage needs of data centers adopting open source as the new norm for high-growth block storage, object stores, and data lakes.
Ceph aims primarily for entirely distributed operation without a single point of failure, scalable to the exabyte level, and freely available.
In this way, administrators have a single, consolidated system that avoids silos and collects the storage within a common management framework. As a result, Ceph consolidates several storage use cases and improves resource utilization. It also lets an organization deploy servers where needed.
" />
<meta name="keywords" content=", cloud, storage" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://blog.miguens.one/posts/2021/06/distributed-storage-with-ceph/" />


    <title>
        
            Distributed Storage with CEPH :: Luis Miguens Blog 
        
    </title>





  <link rel="stylesheet" href="https://blog.miguens.one/main.min.07ea7ac7da67e2e153a7dfa2457bc6a19cca824288d175e223fadc579041bc51.css" integrity="sha256-B&#43;p6x9pn4uFTp9&#43;iRXvGoZzKgkKI0XXiI/rcV5BBvFE=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="https://blog.miguens.one/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://blog.miguens.one/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://blog.miguens.one/favicon-16x16.png">
    <link rel="manifest" href="https://blog.miguens.one/site.webmanifest">
    <link rel="mask-icon" href="https://blog.miguens.one/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://blog.miguens.one/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Distributed Storage with CEPH">
  <meta itemprop="description" content="What is ceph Ceph is a software-defined storage solution designed to address the object, block, and file storage needs of data centers adopting open source as the new norm for high-growth block storage, object stores, and data lakes.
Ceph aims primarily for entirely distributed operation without a single point of failure, scalable to the exabyte level, and freely available.
In this way, administrators have a single, consolidated system that avoids silos and collects the storage within a common management framework. As a result, Ceph consolidates several storage use cases and improves resource utilization. It also lets an organization deploy servers where needed.">
  <meta itemprop="datePublished" content="2021-06-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-06-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1677">
  <meta itemprop="image" content="https://blog.miguens.one/">
  <meta itemprop="keywords" content="Cloud,Storage">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.miguens.one/">
  <meta name="twitter:title" content="Distributed Storage with CEPH">
  <meta name="twitter:description" content="What is ceph Ceph is a software-defined storage solution designed to address the object, block, and file storage needs of data centers adopting open source as the new norm for high-growth block storage, object stores, and data lakes.
Ceph aims primarily for entirely distributed operation without a single point of failure, scalable to the exabyte level, and freely available.
In this way, administrators have a single, consolidated system that avoids silos and collects the storage within a common management framework. As a result, Ceph consolidates several storage use cases and improves resource utilization. It also lets an organization deploy servers where needed.">



    <meta property="og:url" content="https://blog.miguens.one/posts/2021/06/distributed-storage-with-ceph/">
  <meta property="og:site_name" content="Luis Miguens Blog">
  <meta property="og:title" content="Distributed Storage with CEPH">
  <meta property="og:description" content="What is ceph Ceph is a software-defined storage solution designed to address the object, block, and file storage needs of data centers adopting open source as the new norm for high-growth block storage, object stores, and data lakes.
Ceph aims primarily for entirely distributed operation without a single point of failure, scalable to the exabyte level, and freely available.
In this way, administrators have a single, consolidated system that avoids silos and collects the storage within a common management framework. As a result, Ceph consolidates several storage use cases and improves resource utilization. It also lets an organization deploy servers where needed.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-06-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-06-05T00:00:00+00:00">
    <meta property="article:tag" content="Cloud">
    <meta property="article:tag" content="Storage">
    <meta property="og:image" content="https://blog.miguens.one/">




    <meta property="article:section" content="technical" />



    <meta property="article:published_time" content="2021-06-05 00:00:00 &#43;0000 UTC" />









    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZHDRD7M8H9"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-ZHDRD7M8H9');
        }
      </script>



    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://blog.miguens.one/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                $ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://blog.miguens.one/about/">About</a></li><li><a href="https://blog.miguens.one/categories/">Categories</a></li><li><a href="https://blog.miguens.one/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        8 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://blog.miguens.one/posts/2021/06/distributed-storage-with-ceph/">Distributed Storage with CEPH</a>
      </h1>

      

      

      

      <div class="post-content">
        <h2 id="what-is-ceph">What is ceph</h2>
<p>Ceph is a software-defined storage solution designed to address the object, block, and file storage needs of data centers adopting open source as the new norm for high-growth block storage, object stores, and data lakes.</p>
<p>Ceph aims primarily for entirely distributed operation without a single point of failure, scalable to the exabyte level, and freely available.</p>
<p>In this way, administrators have a single, consolidated system that avoids silos and collects the storage within a common management framework. As a result, Ceph consolidates several storage use cases and improves resource utilization. It also lets an organization deploy servers where needed.</p>
<p>Ceph is more challenging to install and maintain than some of the competitors, so if you are looking for a system that addresses a single problem, and you can &ldquo;outsource&rdquo; the redundancy requirements to hardware (or several servers with switchover), ceph might not be your solution for quick deployment.</p>
<h2 id="alternatives-to-ceph">Alternatives to ceph</h2>
<p>As we can use ceph in three categories: filesystem, object storage, and block devices, we need to see for alternatives in each of the fronts:</p>
<h3 id="filesystem">Filesystem</h3>
<p>Sharing a filesystem is the oldest challenge, where we can find classic alternatives to ceph, such as:</p>
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Network_File_System">NFS</a>: Network File System (NFS) is a distributed file system protocol originally developed by Sun Microsystems (Sun) in 1984, allowing a user on a client computer to access files over a computer network much like local storage is accessed. Like many other protocols, NFS builds on the Open Network Computing Remote Procedure Call (ONC RPC) system. NFS is an open standard defined in a Request for Comments (RFC), allowing anyone to implement the protocol.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Samba_%28software%29" title="https://en.wikipedia.org/wiki/Samba_(software)">Samba</a>(SMB): Samba is a free software re-implementation of the SMB networking protocol and was initially developed by Andrew Tridgell. Samba provides file and print services for various Microsoft Windows clients. It can integrate with a Microsoft Windows Server domain, either as a Domain Controller (DC) or as a domain member. In addition, as of version 4, it supports Active Directory and Microsoft Windows NT domains.</p>
</li>
</ul>
<h3 id="object-storage">Object Storage</h3>
<ul>
<li><a href="https://min.io/">Minio</a>: Object Storage for the era of the Hybrid Cloud. MinIO&rsquo;s high-performance, Kubernetes-native object storage suite is built for the demands of the hybrid cloud. Software-defined, it delivers
a consistent experience across every Kubernetes environment.</li>
</ul>
<h3 id="block-devices">Block devices</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/LIO_%28SCSI_target%29" title="https://en.wikipedia.org/wiki/LIO_(SCSI_target) ">LIO</a>: In computing, Linux-IO (LIO) Target is an open-source implementation of the SCSI target that has become the standard one included in the Linux kernel. Internally, LIO does not initiate sessions but instead provides one or more Logical Unit Numbers (LUNs), waits for SCSI commands from a SCSI initiator, and performs required input/output data transfers. LIO supports standard storage fabrics, including FCoE, Fibre Channel, IEEE 1394, iSCSI, iSCSI Extensions for RDMA (iSER), SCSI RDMA Protocol (SRP), and USB. It is included in most Linux distributions; native support for LIO in QEMU/KVM, libvirt, and OpenStack makes LIO a storage option for cloud deployments.</li>
</ul>
<p><em>Source of all descriptions: Official webpage and Wikipedia</em></p>
<h2 id="summary">Summary</h2>
<p>I will install ceph and test the functionality for sharing a filesystem and the object-store. I consider those two the most important parts of ceph over the possibility of defining and sharing block devices.</p>
<p>The logic behind my tests is that most development nowadays moves toward microservices and containerization, moving away from virtualization techniques. Therefore, the possibility of having centralized storage for block devices is significant. Instead, in microservices and container, I consider more important to be able to mount volumes in our container and save/read data in object storages.</p>
<h2 id="installing-ceph">Installing ceph</h2>
<p>As the latest version (pacific), the recommend installation way is via the command <code>cephadm</code>. The application deploys and manages a ceph cluster. It does this by connecting the manager daemon to hosts via SSH. The manager daemon can add, remove, and update ceph containers.</p>
<p>The requirements are:</p>
<ul>
<li>Python 3</li>
<li>Systemd</li>
<li>Podman or Docker for running containers</li>
<li>Time synchronization (such as chrony or NTP)</li>
<li>LVM2 for provisioning storage devices</li>
</ul>
<p>To install, we shall run the following commands as root. The installation will leave the executable in the <code>/usr/sbin</code> directory.</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>curl --remote-name --location https://github.com/ceph/ceph/raw/pacific/src/cephadm/cephadm
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>chmod +x cephadm
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>./cephadm add-repo --release pacific
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>./cephadm install
</span></span></code></pre></div></li>
</ul>
<p>Now to provide the services to start a cluster, we need to boostrap:</p>
<p><code>cephadm bootstrap --mon-IP &lt;YOUR LOCAL IP ADDRESS&gt;</code></p>
<p>After the installation, you will see something similar to the following.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>Ceph Dashboard is now available at:
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>             URL: https://BARE:8443/
</span></span><span style="display:flex;"><span>            User: admin
</span></span><span style="display:flex;"><span>        Password: &lt;some random password&gt;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>You can access the Ceph CLI with:
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        sudo /usr/sbin/cephadm shell --fsid 6945738e-c42a-11eb-b8ba-ff25ba285015 -c /etc/ceph/ceph.conf -k /etc/ceph/ceph.client.admin.keyring
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>Please consider enabling telemetry to help improve Ceph:
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        ceph telemetry on
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>For more information, see:
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        https://docs.ceph.com/docs/master/mgr/telemetry/ 
</span></span></code></pre></div><p>You can access the web interface from the machine you installed ceph.</p>
<p>If you wish to access from another machine, consider a port forward with ssh, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ssh luis@bare.local -L 8443:localhost:8443
</span></span></code></pre></div><p>After the forwarding, we can access another machine via <code>https://localhost:8443</code>, log in and change the random password generated by the bootstrap command.</p>
<h3 id="install-ceph-cli">Install ceph cli</h3>
<p>To install the <code>ceph</code> command, we run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>cephadm install ceph-common
</span></span></code></pre></div><h2 id="adding-a-disk-to-the-cluster">Adding a disk to the cluster</h2>
<p>To add all available unused space to CEPH, we have the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph orch apply osd --all-available-devices
</span></span></code></pre></div><p>We can add <code>--dry-run</code>, to simulate the command rather than execute.</p>
<p>Otherwise, we will need to specify the device to use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph orch daemon add osd &lt;hostname&gt;:/dev/sd&lt;letter&gt;
</span></span></code></pre></div><p><strong>Important to note that it is different from the minio object store, in which we will specify a directory to use. In ceph, we need to select a storage device, raw, without any filesystem nor partitions.</strong></p>
<p>In my case, I have two external USB Disks that I am going to use for storage. Because the disk contains some old data, I will (partially) zero the devices.</p>
<h3 id="zeroing-existing-hard-drives">Zeroing existing hard drives</h3>
<p>The steps to zero one of the external USB disks, located in <code>/dev/sdd</code> are:</p>
<p><strong>EXTREME CAUTION: Double check your command. Otherwise, you could end up destroying important data or your own OS.</strong></p>
<ol>
<li>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>dd if=/dev/zero of=/dev/sdd
</span></span></code></pre></div></li>
<li>
<p>Let it run for some seconds and CTRL+C the command</p>
</li>
</ol>
<h3 id="adding-the-disks-to-the-cluster-example">Adding the disks to the cluster: example</h3>
<p>After zeroing both devices, I will run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph orch apply osd --all-available-devices --dry-run`
</span></span></code></pre></div><p>You will need to execute the command twice, the first to trigger the scan and the second time to see the results.</p>
<p>After a while (3 minutes in my case), the system detected both devices, and I executed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph orch apply osd --all-available-devices`
</span></span></code></pre></div><h2 id="running-without-redundancy">Running without redundancy</h2>
<p>We will need to change some rules regarding the size of the pool. By default, ceph is fault-tolerant, which means that data get replicated along with several devices, or at least enough information is saved to build the information back.</p>
<p>In our case, we are only experimenting with ceph, and I don&rsquo;t have the resources for a recommended installation.
However, in production, you should remember that you need several machines (&gt;3) with several hard drives (&gt;3 per machine) to do a robust, fault-tolerant installation.</p>
<p>We will proceed to disable the functionality mentioned above of ceph, using it as a single device. We need to modify the following relevant values in a cluster configuration (via web GUI), using level advance:</p>
<ul>
<li>osd_pool_default_size to 1</li>
<li>osd_pool_default_min size to 1</li>
<li>mon_allow_pool_size_one to True</li>
</ul>
<p>Nonetheless, the device_health device was already created with a size of 3. This is a pool created automatically by ceph to store the health data of the whole cluster. We can change and remove the redundancy, running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph osd pool set device_health_metrics size 1
</span></span></code></pre></div><h2 id="creating-a-filesystem">Creating a filesystem</h2>
<p>Now I will create a new filesystem in Ceph, named Bigfoot, and limit it to 1 replica.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph fs volume create Bigfoot
</span></span></code></pre></div><h3 id="testing-the-filesystem">Testing the filesystem</h3>
<p>First, we need to install <code>ceph-fuse</code> in the machine we want to perform the test:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>apt-get install ceph-fuse ceph-common
</span></span></code></pre></div><p>Adapt the installation command in case you are in a not Debian-based distribution.</p>
<p>Now, we can mount:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph-fuse -id admin -m 192.168.178.30:6789 ./test/
</span></span></code></pre></div><p>I created several directories and files in the test mount point and checking in the Dashboard, and you can see the user is connected to the cluster. You can also see in the Dashboard the directories created in the root of Bigfoot.</p>
<h2 id="creating-an-object-storage">Creating an object storage</h2>
<p>Now, let&rsquo;s set up our object storage. First, we need to create a pool the services and the pool:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph orch apply rgw Bigfoot &#39;--placement=1 BARE&#39; --port=8000
</span></span></code></pre></div><p>We also need to add object storage to the Dashboard.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>radosgw-admin user create --uid=1000 --display-name=admin --system
</span></span></code></pre></div><p>Next, need to save the credentials and pass them to the ceph dashboard. For that, we can run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>radosgw-admin user info --uid=1000`
</span></span></code></pre></div><p>And saving the access and secret key in files, we run the commands:</p>
<ul>
<li><code>ceph dashboard set-rgw-API-access-key -i access.key</code></li>
<li><code>ceph dashboard set-rgw-API-secret-key -i secret.key</code></li>
</ul>
<p>We should see in the dashboard access to the Object Gateway, and we can create a Bucket with the name bigfoot and owner the user 1000 I create previously. We can leave all options of the Bucket as by default.</p>
<h3 id="testing-the-object-storage">Testing the object storage</h3>
<p>First, we need to install s3fs, so we execute as root:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>apt-get install s3fs
</span></span></code></pre></div><p>We also need to create a file with the credentials for s3fs. For that, we will need the <code>access.key</code> and <code>secret.key</code> files of the last part:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>echo $(cat user):$(cat secret) &gt; s3password
</span></span></code></pre></div><p>Finally we can mount the object storage with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>s3fs bigfoot /root/test -o passwd_file=/root/s3password -o url=http://192.168.178.30:8000/ -o use_path_request_style
</span></span></code></pre></div><p>With an editor, I created five files with random text and saved them. In the Dashboard, I can see that the object storage now contains five objects.</p>
<h2 id="creating-a-block-device">Creating a block device</h2>
<p>Last we can create an image to use as a remote block device for virtual machines thanks to iSCSI.</p>
<p>First, we need to create a pool for our block disks, so we type:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>ceph osd pool create hdpool
</span></span><span style="display:flex;"><span>ceph osd pool application enable hdpool rbd
</span></span></code></pre></div><p>Next, we go to the Dashboard, and under Block -&gt; Images, we click on &ldquo;Create&rdquo;</p>
<p>We fill all data required by &ldquo;*&rdquo;, and leave the rest as default. For example, I used the Name of Shared_Disk and 5GB of space.</p>
<p>This way, we can create a block disk and share it with virtualization software or operating systems (Windows 10, Linux, etc.) supporting iSCSI.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://blog.miguens.one/tags/cloud/">cloud</a></span>
        <span class="tag"><a href="https://blog.miguens.one/tags/storage/">storage</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://blog.miguens.one/categories/technical/">technical</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1677 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-06-05
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Distributed%20Storage%20with%20CEPH&amp;caption=Distributed%20Storage%20with%20CEPH&amp;canonicalUrl=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Distributed%20Storage%20with%20CEPH&amp;body=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f&amp;media=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f;description=Distributed%20Storage%20with%20CEPH" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f&amp;title=Distributed%20Storage%20with%20CEPH&amp;summary=Distributed%20Storage%20with%20CEPH&amp;source=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f&amp;resubmit=true&amp;title=Distributed%20Storage%20with%20CEPH" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f;title=Distributed%20Storage%20with%20CEPH" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Distributed%20Storage%20with%20CEPH%20https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f&amp;t=Distributed%20Storage%20with%20CEPH" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Distributed%20Storage%20with%20CEPH&amp;url=https%3a%2f%2fblog.miguens.one%2fposts%2f2021%2f06%2fdistributed-storage-with-ceph%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://blog.miguens.one/posts/2021/06/how-to-download-all-certificates-of-udemy/">
                    <span class="button__icon">←</span>
                    <span class="button__text">How to download all certificates of UDEMY</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://blog.miguens.one/posts/2021/06/el-arte-de-no-amargarse-la-vida/">
                    <span class="button__text">El arte de no amargarse la vida</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://blog.miguens.one/bundle.min.ad54ad97364f77ede35def9096b162bb1f0b3973aa50b080f5e82fa147f6882e2a7200d7535adbf9b51bebf939f1c1ca9bbe6be87530092aca720eac4a226fda.js" integrity="sha512-rVStlzZPd&#43;3jXe&#43;QlrFiux8LOXOqULCA9egvoUf2iC4qcgDXU1rb&#43;bUb6/k58cHKm75r6HUwCSrKcg6sSiJv2g=="></script>




    </body>
</html>
